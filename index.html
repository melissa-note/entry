<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>予約申込みフォーム</title>
    <link rel="stylesheet" href="https://melissa-note.github.io/entry/style.css"/>
</head>
<body>
    <form class="contact-box">
        <p class="dotted2 bold">日時</p>
            <select name="date" id="date" required>
<option value="">選択してください</option>
<option value="【新宿】7/29（土）18:30～">【新宿】7/29（土）18:30～20:30</option>
<option value="【新宿】8/5（土）18:30～">【新宿】8/5（土）18:30～20:30</option>
<option value="【新宿】8/19（土）18:30～">【新宿】8/19（土）18:30～20:30</option>
            </select>
        
    <div class="contact-box">
        <p class="fz-14px orange">あなたと他のメンバーとの相性診断のため、質問に回答してください。</p>
<p class="must fz-6px">*初回のみ必須</p>
        <p class="fz-6px">*変更なければ回答不要です。予約エラーが出る場合は全て回答をお願いします。</p>
<details><summary class="ans orange">回答する（所要時間約1分）</summary>
    
    <div class="contact-box">
    <p class="bold">あなたのことについて</p>        
    <p class="dotted2">● ニックネーム</p>
        <p class ="must fz-6px">*当日の参加者に公開されます。</p>
        <div>            
            <input class="form-control w-100 mt-1" name="nname">                                                                                                                    
        </div>
        <p class="dotted2">● 年齢</p>        
        <p class ="must fz-6px">*20歳以上から参加できます。</p>
        <div>
            <input type = "number" name="age0" min="20" max="70">歳                                                                                                            
        </div>
        <div>
        <p class="dotted2">● 見た目</p>
        <p class="fz-6px">*複数選択可</p>
        <input id="l1" type="checkbox" name="looks0" value="フェム（女性っぽい）"><label for="l1">フェム（女性っぽい）</label>
        <input id="l2" type="checkbox" name="looks0" value="中性（その中間）"><label for="l2">中性（その中間）</label>
        <input id="l3" type="checkbox" name="looks0" value="ボイ（男性っぽい）"><label for="l3">ボイ（男性っぽい）</label>
        <input id="l4" type="checkbox" name="looks0" value="わからない"><label for="l4">わからない</label>
        </div>
    </div>
    <div class="contact-box">
<p class="bold">理想の相手について</p>        
        <div>   
        <p class="dotted1">● 年齢層</p>
        <p class="fz-6px">*複数選択可</p>              
        <input id="20" type="checkbox" name="age1" value="20代"><label for="20">20代</label>
        <input id="30" type="checkbox" name="age1" value="30代"><label for="30">30代</label>
        <input id="40" type="checkbox" name="age1" value="40代"><label for="40">40代</label>
        <input id="50" type="checkbox" name="age1" value="50代"><label for="50">50代</label>
        <input id="any0" type="checkbox" name="age1" value="年齢気にしない"><label for="any0">年齢気にしない</label>                                                                                                      
        </div>
        <div>
        <p class="dotted1">● 見た目</p>
        <p class="fz-6px">*複数選択可</p>    
        <input id="l5" type="checkbox" name="looks1" value="フェム（女性っぽい）"><label for="l5">フェム（女性っぽい）</label>
        <input id="l6" type="checkbox" name="looks1" value="中性（その中間）"><label for="l6">中性（その中間）</label>
        <input id="l7" type="checkbox" name="looks1" value="ボイ（男性っぽい）"><label for="l7">ボイ（男性っぽい）</label>
        <input id="l8" type="checkbox" name="looks1" value="見た目気にしない"><label for="l8">見た目気にしない</label>
    </div>   </div>
       </details></div>
        <p class="dotted">備考欄</p>
        <div>
            <textarea class="input-box" name="bikou" cols="30" rows="3" id="bikou"></textarea>
        </div>
        <input type="submit" class="btn btn--red btn--radius btn--cubic" value="この内容で予約">
    </form>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>

        $(document).ready(function () {
            const liffId = "2000009774-ly65pKbp";
            initializeLiff(liffId);
        })

        function initializeLiff(liffId) {
            liff.init({
                liffId: liffId
            }).then(() => {
                initializeApp();
            }).catch((err) => {
                console.log('LIFF Initialization failed ', err);
            });
        }

        function sendText(text) {
            liff.sendMessages([{
                'type': 'text',
                'text': text
            }]).then(function () {
                liff.closeWindow();
            }).catch(function (error) {
                window.alert('Failed to send message ' + error);
            });
        }

        const params = (new URL(document.location)).searchParams;
        const key = params.get('key');

        $(function () {
            $('form').submit(function () {
                const date = $("#date").val();
                const bikou = $('textarea[name="bikou"]').val();//document.getElementById("bikou").value;
                const nname = $('input[name="nname"]').val();
                const age0  = $('input[name="age0"]').val();
                const looks0 = $('input[name=looks0]:checked').map(function(){
                   return $(this).val();
                 }).get();
                const age1 = $('input[name=age1]:checked').map(function(){
                   return $(this).val();
                 }).get();
                const looks1 = $('input[name=looks1]:checked').map(function(){
                   return $(this).val();
                 }).get();
                const msg = `--- 申込み内容 ---\n${date}\n備考：${bikou}\n${nname}-${age0}-${looks0}\n${age1}-${looks1}`;
                sendText(msg);
                return false;
            });
        });

    </script>

</body>
</html>


